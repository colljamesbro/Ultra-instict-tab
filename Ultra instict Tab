-- Get services
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Mouse = Player:GetMouse()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Teams = game:GetService("Teams")
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Set up UI
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = PlayerGui

-- Background setup
local background = Instance.new("ImageLabel")
background.Size = UDim2.new(1, 0, 1, 0)
background.Image = "rbxassetid://114827941861763"
background.Parent = screenGui

-- Create the password box
local passwordFrame = Instance.new("Frame")
passwordFrame.Size = UDim2.new(0, 300, 0, 200)
passwordFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
passwordFrame.BackgroundTransparency = 0.5
passwordFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
passwordFrame.Parent = screenGui

local passwordLabel = Instance.new("TextLabel")
passwordLabel.Size = UDim2.new(1, 0, 0.2, 0)
passwordLabel.Text = "Enter the password:"
passwordLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
passwordLabel.TextSize = 18
passwordLabel.BackgroundTransparency = 1
passwordLabel.Parent = passwordFrame

local passwordBox = Instance.new("TextBox")
passwordBox.Size = UDim2.new(1, -20, 0.2, 0)
passwordBox.Position = UDim2.new(0, 10, 0.25, 0)
passwordBox.PlaceholderText = "Password"
passwordBox.TextColor3 = Color3.fromRGB(255, 255, 255)
passwordBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
passwordBox.Parent = passwordFrame

local submitButton = Instance.new("TextButton")
submitButton.Size = UDim2.new(1, -20, 0.2, 0)
submitButton.Position = UDim2.new(0, 10, 0.5, 0)
submitButton.Text = "Submit"
submitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
submitButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
submitButton.Parent = passwordFrame

-- Button to toggle teleportation
local teleportButton = Instance.new("TextButton")
teleportButton.Size = UDim2.new(0, 100, 0, 50)
teleportButton.Position = UDim2.new(0.5, -50, 0.7, 0)
teleportButton.Text = "Teleport Off"
teleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
teleportButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
teleportButton.Parent = screenGui

local teleportEnabled = false

-- ESP Setup (for Inmates team only)
local function setupESP(player)
    if player.Team and player.Team.Name == "Inmates" then
        local espPart = Instance.new("Part")
        espPart.Size = Vector3.new(2, 2, 2)
        espPart.Anchored = true
        espPart.CanCollide = false
        espPart.BrickColor = BrickColor.new("Bright red")
        espPart.Parent = player.Character
        espPart.Position = player.Character.HumanoidRootPart.Position
        espPart.Name = "ESPPart"
        local billboardGui = Instance.new("BillboardGui")
        billboardGui.Parent = espPart
        billboardGui.Size = UDim2.new(0, 200, 0, 50)
        billboardGui.Adornee = espPart
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.Text = player.Name
        label.TextColor3 = Color3.fromRGB(255, 255, 255)
        label.TextSize = 14
        label.Parent = billboardGui
    end
end

-- Function to teleport behind someone
local function teleportBehind(player)
    if teleportEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local targetPosition = player.Character.HumanoidRootPart.Position
        local newPosition = targetPosition - (player.Character.HumanoidRootPart.CFrame.LookVector * 5)
        Character:SetPrimaryPartCFrame(CFrame.new(newPosition))
    end
end

-- Check if hit (assuming the hit detection script is handled separately)
Mouse.Button1Down:Connect(function()
    if teleportEnabled then
        teleportBehind(Mouse.Target)
    end
end)

-- Check password entry
submitButton.MouseButton1Click:Connect(function()
    if passwordBox.Text == "Colljamesbro" then
        passwordFrame.Visible = false
        teleportButton.Visible = true
    else
        passwordBox.Text = "Wrong Password!"
    end
end)

-- Toggle teleportation
teleportButton.MouseButton1Click:Connect(function()
    if teleportEnabled then
        teleportButton.Text = "Teleport Off"
        teleportButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        teleportEnabled = false
    else
        teleportButton.Text = "Teleport On"
        teleportButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        teleportEnabled = true
    end
end)

-- Lock on team 'Inmates'
local function lockTeamInmates()
    local function checkTeam()
        if Player.Team and Player.Team.Name == "Inmates" then
            -- Your custom team lock logic can go here.
            -- For now, it's just showing a message.
            print("Locked to Inmates team.")
        end
    end
    checkTeam()
    -- Run lock on Inmates team every second
    while true do
        wait(1)
        checkTeam()
    end
end

-- Start ESP for all players in the game
for _, player in ipairs(Players:GetPlayers()) do
    setupESP(player)
end

-- Start checking team lock
lockTeamInmates()
